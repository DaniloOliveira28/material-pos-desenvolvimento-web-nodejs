<!DOCTYPE html>
<html>
  <head>
    <title>Cotações</title>
  </head>
  <body>
    <form onsubmit="event.preventDefault(); submeterCotacao(event.target);">
      <p>
        Marca:
        <input name="marca">
      </p>
      <p>
        Modelo:
        <input name="modelo">
      </p>
      <p>
        Ano:
        <input name="ano">
      </p>
      <p>
        Quantidade de veículos:
        <input name="quantidade" type="number">
      </p>
      <p>
        E-mail para retorno:
        <input name="email">
      </p>
      <p>
        <button>Cotar!</button>
      </p>
    </form>
    <script>

      function submeterCotacao(formElement) {
        const data = new FormData(formElement);
        fetch('/cotacao', {
          method: 'POST',
          body: data
        }).then(resp => {
          if (resp.status == 204) {
            alert('Sua cotação foi solicitada, verifique seu e-mail em alguns instantes!');
            formElement.reset();
          } else {
            alert('Não foi possível realizar a cotação!');
          }
        }).catch(err => {
          console.log(err);
          alert('Não foi possível realizar a cotação!');
        });
      }

    </script>
  </body>
</html>
